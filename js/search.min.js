/* **********************************************
     Begin URI.min.js
********************************************** *//*! URI.js v1.11.2 http://medialize.github.com/URI.js/ *//* build contains: IPv6.js, punycode.js, SecondLevelDomains.js, URI.js, URITemplate.js */(function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(t):e.IPv6=t(e)})(this,function(e){var t=e&&e.IPv6;return{best:function(e){e=e.toLowerCase().split(":");var t=e.length,n=8;""===e[0]&&""===e[1]&&""===e[2]?(e.shift(),e.shift()):""===e[0]&&""===e[1]?e.shift():""===e[t-1]&&""===e[t-2]&&e.pop();t=e.length;-1!==e[t-1].indexOf(".")&&(n=7);var r;for(r=0;r<t&&""!==e[r];r++);if(r<n)for(e.splice(r,1,"0000");e.length<n;)e.splice(r,0,"0000");for(r=0;r<n;r++){for(var t=e[r].split(""),i=0;3>i;i++){if(!("0"===t[0]&&1<t.length))break;t.splice(0,1)}e[r]=t.join("")}var t=-1,s=i=0,o=-1,u=!1;for(r=0;r<n;r++)u?"0"===e[r]?s+=1:(u=!1,s>i&&(t=o,i=s)):"0"==e[r]&&(u=!0,o=r,s=1);s>i&&(t=o,i=s);1<i&&e.splice(t,i,"");t=e.length;n="";""===e[0]&&(beststr=":");for(r=0;r<t;r++){n+=e[r];if(r===t-1)break;n+=":"}""===e[t-1]&&(n+=":");return n},noConflict:function(){e.IPv6===this&&(e.IPv6=t);return this}}});(function(e){function t(e){throw RangeError(T[e])}function n(e,t){for(var n=e.length;n--;)e[n]=t(e[n]);return e}function r(e){for(var t=[],n=0,r=e.length,i,s;n<r;)i=e.charCodeAt(n++),55296<=i&&56319>=i&&n<r?(s=e.charCodeAt(n++),56320==(s&64512)?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),n--)):t.push(i);return t}function i(e){return n(e,function(e){var t="";65535<e&&(e-=65536,t+=k(e>>>10&1023|55296),e=56320|e&1023);return t+=k(e)}).join("")}function s(e,t,n){var r=0;e=n?C(e/g):e>>1;for(e+=C(e/t);e>N*v>>1;r+=p)e=C(e/N);return C(r+(N+1)*e/(e+m))}function o(e){var n=[],r=e.length,o,u=0,a=b,f=y,l,c,m,g,E;l=e.lastIndexOf(w);0>l&&(l=0);for(c=0;c<l;++c)128<=e.charCodeAt(c)&&t("not-basic"),n.push(e.charCodeAt(c));for(l=0<l?l+1:0;l<r;){c=u;o=1;for(m=p;;m+=p){l>=r&&t("invalid-input");g=e.charCodeAt(l++);g=10>g-48?g-22:26>g-65?g-65:26>g-97?g-97:p;(g>=p||g>C((h-u)/o))&&t("overflow");u+=g*o;E=m<=f?d:m>=f+v?v:m-f;if(g<E)break;g=p-E;o>C(h/g)&&t("overflow");o*=g}o=n.length+1;f=s(u-c,o,0==c);C(u/o)>h-a&&t("overflow");a+=C(u/o);u%=o;n.splice(u++,0,a)}return i(n)}function u(e){var n,i,o,u,a,f,l,c,m,g=[],E,S,x;e=r(e);E=e.length;n=b;i=0;a=y;for(f=0;f<E;++f)m=e[f],128>m&&g.push(k(m));for((o=u=g.length)&&g.push(w);o<E;){l=h;for(f=0;f<E;++f)m=e[f],m>=n&&m<l&&(l=m);S=o+1;l-n>C((h-i)/S)&&t("overflow");i+=(l-n)*S;n=l;for(f=0;f<E;++f)if(m=e[f],m<n&&++i>h&&t("overflow"),m==n){c=i;for(l=p;;l+=p){m=l<=a?d:l>=a+v?v:l-a;if(c<m)break;x=c-m;c=p-m;g.push(k(m+x%c+22+75*(26>m+x%c)-0));c=C(x/c)}g.push(k(c+22+75*(26>c)-0));a=s(i,S,o==u);i=0;++o}++i;++n}return g.join("")}var a="object"==typeof exports&&exports,f="object"==typeof module&&module&&module.exports==a&&module,l="object"==typeof global&&global;if(l.global===l||l.window===l)e=l;var c,h=2147483647,p=36,d=1,v=26,m=38,g=700,y=72,b=128,w="-",E=/^xn--/,S=/[^ -~]/,x=/\x2E|\u3002|\uFF0E|\uFF61/g,T={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},N=p-d,C=Math.floor,k=String.fromCharCode,L;c={version:"1.2.3",ucs2:{decode:r,encode:i},decode:o,encode:u,toASCII:function(e){return n(e.split(x),function(e){return S.test(e)?"xn--"+u(e):e}).join(".")},toUnicode:function(e){return n(e.split(x),function(e){return E.test(e)?o(e.slice(4).toLowerCase()):e}).join(".")}};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return c});else if(a&&!a.nodeType)if(f)f.exports=c;else for(L in c)c.hasOwnProperty(L)&&(a[L]=c[L]);else e.punycode=c})(this);(function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define(t):e.SecondLevelDomains=t(e)})(this,function(e){var t=e&&e.SecondLevelDomains,n=Object.prototype.hasOwnProperty,r={list:{ac:"com|gov|mil|net|org",ae:"ac|co|gov|mil|name|net|org|pro|sch",af:"com|edu|gov|net|org",al:"com|edu|gov|mil|net|org",ao:"co|ed|gv|it|og|pb",ar:"com|edu|gob|gov|int|mil|net|org|tur",at:"ac|co|gv|or",au:"asn|com|csiro|edu|gov|id|net|org",ba:"co|com|edu|gov|mil|net|org|rs|unbi|unmo|unsa|untz|unze",bb:"biz|co|com|edu|gov|info|net|org|store|tv",bh:"biz|cc|com|edu|gov|info|net|org",bn:"com|edu|gov|net|org",bo:"com|edu|gob|gov|int|mil|net|org|tv",br:"adm|adv|agr|am|arq|art|ato|b|bio|blog|bmd|cim|cng|cnt|com|coop|ecn|edu|eng|esp|etc|eti|far|flog|fm|fnd|fot|fst|g12|ggf|gov|imb|ind|inf|jor|jus|lel|mat|med|mil|mus|net|nom|not|ntr|odo|org|ppg|pro|psc|psi|qsl|rec|slg|srv|tmp|trd|tur|tv|vet|vlog|wiki|zlg",bs:"com|edu|gov|net|org",bz:"du|et|om|ov|rg",ca:"ab|bc|mb|nb|nf|nl|ns|nt|nu|on|pe|qc|sk|yk",ck:"biz|co|edu|gen|gov|info|net|org",cn:"ac|ah|bj|com|cq|edu|fj|gd|gov|gs|gx|gz|ha|hb|he|hi|hl|hn|jl|js|jx|ln|mil|net|nm|nx|org|qh|sc|sd|sh|sn|sx|tj|tw|xj|xz|yn|zj",co:"com|edu|gov|mil|net|nom|org",cr:"ac|c|co|ed|fi|go|or|sa",cy:"ac|biz|com|ekloges|gov|ltd|name|net|org|parliament|press|pro|tm","do":"art|com|edu|gob|gov|mil|net|org|sld|web",dz:"art|asso|com|edu|gov|net|org|pol",ec:"com|edu|fin|gov|info|med|mil|net|org|pro",eg:"com|edu|eun|gov|mil|name|net|org|sci",er:"com|edu|gov|ind|mil|net|org|rochest|w",es:"com|edu|gob|nom|org",et:"biz|com|edu|gov|info|name|net|org",fj:"ac|biz|com|info|mil|name|net|org|pro",fk:"ac|co|gov|net|nom|org",fr:"asso|com|f|gouv|nom|prd|presse|tm",gg:"co|net|org",gh:"com|edu|gov|mil|org",gn:"ac|com|gov|net|org",gr:"com|edu|gov|mil|net|org",gt:"com|edu|gob|ind|mil|net|org",gu:"com|edu|gov|net|org",hk:"com|edu|gov|idv|net|org",id:"ac|co|go|mil|net|or|sch|web",il:"ac|co|gov|idf|k12|muni|net|org","in":"ac|co|edu|ernet|firm|gen|gov|i|ind|mil|net|nic|org|res",iq:"com|edu|gov|i|mil|net|org",ir:"ac|co|dnssec|gov|i|id|net|org|sch",it:"edu|gov",je:"co|net|org",jo:"com|edu|gov|mil|name|net|org|sch",jp:"ac|ad|co|ed|go|gr|lg|ne|or",ke:"ac|co|go|info|me|mobi|ne|or|sc",kh:"com|edu|gov|mil|net|org|per",ki:"biz|com|de|edu|gov|info|mob|net|org|tel",km:"asso|com|coop|edu|gouv|k|medecin|mil|nom|notaires|pharmaciens|presse|tm|veterinaire",kn:"edu|gov|net|org",kr:"ac|busan|chungbuk|chungnam|co|daegu|daejeon|es|gangwon|go|gwangju|gyeongbuk|gyeonggi|gyeongnam|hs|incheon|jeju|jeonbuk|jeonnam|k|kg|mil|ms|ne|or|pe|re|sc|seoul|ulsan",kw:"com|edu|gov|net|org",ky:"com|edu|gov|net|org",kz:"com|edu|gov|mil|net|org",lb:"com|edu|gov|net|org",lk:"assn|com|edu|gov|grp|hotel|int|ltd|net|ngo|org|sch|soc|web",lr:"com|edu|gov|net|org",lv:"asn|com|conf|edu|gov|id|mil|net|org",ly:"com|edu|gov|id|med|net|org|plc|sch",ma:"ac|co|gov|m|net|org|press",mc:"asso|tm",me:"ac|co|edu|gov|its|net|org|priv",mg:"com|edu|gov|mil|nom|org|prd|tm",mk:"com|edu|gov|inf|name|net|org|pro",ml:"com|edu|gov|net|org|presse",mn:"edu|gov|org",mo:"com|edu|gov|net|org",mt:"com|edu|gov|net|org",mv:"aero|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro",mw:"ac|co|com|coop|edu|gov|int|museum|net|org",mx:"com|edu|gob|net|org",my:"com|edu|gov|mil|name|net|org|sch",nf:"arts|com|firm|info|net|other|per|rec|store|web",ng:"biz|com|edu|gov|mil|mobi|name|net|org|sch",ni:"ac|co|com|edu|gob|mil|net|nom|org",np:"com|edu|gov|mil|net|org",nr:"biz|com|edu|gov|info|net|org",om:"ac|biz|co|com|edu|gov|med|mil|museum|net|org|pro|sch",pe:"com|edu|gob|mil|net|nom|org|sld",ph:"com|edu|gov|i|mil|net|ngo|org",pk:"biz|com|edu|fam|gob|gok|gon|gop|gos|gov|net|org|web",pl:"art|bialystok|biz|com|edu|gda|gdansk|gorzow|gov|info|katowice|krakow|lodz|lublin|mil|net|ngo|olsztyn|org|poznan|pwr|radom|slupsk|szczecin|torun|warszawa|waw|wroc|wroclaw|zgora",pr:"ac|biz|com|edu|est|gov|info|isla|name|net|org|pro|prof",ps:"com|edu|gov|net|org|plo|sec",pw:"belau|co|ed|go|ne|or",ro:"arts|com|firm|info|nom|nt|org|rec|store|tm|www",rs:"ac|co|edu|gov|in|org",sb:"com|edu|gov|net|org",sc:"com|edu|gov|net|org",sh:"co|com|edu|gov|net|nom|org",sl:"com|edu|gov|net|org",st:"co|com|consulado|edu|embaixada|gov|mil|net|org|principe|saotome|store",sv:"com|edu|gob|org|red",sz:"ac|co|org",tr:"av|bbs|bel|biz|com|dr|edu|gen|gov|info|k12|name|net|org|pol|tel|tsk|tv|web",tt:"aero|biz|cat|co|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel",tw:"club|com|ebiz|edu|game|gov|idv|mil|net|org",mu:"ac|co|com|gov|net|or|org",mz:"ac|co|edu|gov|org",na:"co|com",nz:"ac|co|cri|geek|gen|govt|health|iwi|maori|mil|net|org|parliament|school",pa:"abo|ac|com|edu|gob|ing|med|net|nom|org|sld",pt:"com|edu|gov|int|net|nome|org|publ",py:"com|edu|gov|mil|net|org",qa:"com|edu|gov|mil|net|org",re:"asso|com|nom",ru:"ac|adygeya|altai|amur|arkhangelsk|astrakhan|bashkiria|belgorod|bir|bryansk|buryatia|cbg|chel|chelyabinsk|chita|chukotka|chuvashia|com|dagestan|e-burg|edu|gov|grozny|int|irkutsk|ivanovo|izhevsk|jar|joshkar-ola|kalmykia|kaluga|kamchatka|karelia|kazan|kchr|kemerovo|khabarovsk|khakassia|khv|kirov|koenig|komi|kostroma|kranoyarsk|kuban|kurgan|kursk|lipetsk|magadan|mari|mari-el|marine|mil|mordovia|mosreg|msk|murmansk|nalchik|net|nnov|nov|novosibirsk|nsk|omsk|orenburg|org|oryol|penza|perm|pp|pskov|ptz|rnd|ryazan|sakhalin|samara|saratov|simbirsk|smolensk|spb|stavropol|stv|surgut|tambov|tatarstan|tom|tomsk|tsaritsyn|tsk|tula|tuva|tver|tyumen|udm|udmurtia|ulan-ude|vladikavkaz|vladimir|vladivostok|volgograd|vologda|voronezh|vrn|vyatka|yakutia|yamal|yekaterinburg|yuzhno-sakhalinsk",rw:"ac|co|com|edu|gouv|gov|int|mil|net",sa:"com|edu|gov|med|net|org|pub|sch",sd:"com|edu|gov|info|med|net|org|tv",se:"a|ac|b|bd|c|d|e|f|g|h|i|k|l|m|n|o|org|p|parti|pp|press|r|s|t|tm|u|w|x|y|z",sg:"com|edu|gov|idn|net|org|per",sn:"art|com|edu|gouv|org|perso|univ",sy:"com|edu|gov|mil|net|news|org",th:"ac|co|go|in|mi|net|or",tj:"ac|biz|co|com|edu|go|gov|info|int|mil|name|net|nic|org|test|web",tn:"agrinet|com|defense|edunet|ens|fin|gov|ind|info|intl|mincom|nat|net|org|perso|rnrt|rns|rnu|tourism",tz:"ac|co|go|ne|or",ua:"biz|cherkassy|chernigov|chernovtsy|ck|cn|co|com|crimea|cv|dn|dnepropetrovsk|donetsk|dp|edu|gov|if|in|ivano-frankivsk|kh|kharkov|kherson|khmelnitskiy|kiev|kirovograd|km|kr|ks|kv|lg|lugansk|lutsk|lviv|me|mk|net|nikolaev|od|odessa|org|pl|poltava|pp|rovno|rv|sebastopol|sumy|te|ternopil|uzhgorod|vinnica|vn|zaporizhzhe|zhitomir|zp|zt",ug:"ac|co|go|ne|or|org|sc",uk:"ac|bl|british-library|co|cym|gov|govt|icnet|jet|lea|ltd|me|mil|mod|national-library-scotland|nel|net|nhs|nic|nls|org|orgn|parliament|plc|police|sch|scot|soc",us:"dni|fed|isa|kids|nsn",uy:"com|edu|gub|mil|net|org",ve:"co|com|edu|gob|info|mil|net|org|web",vi:"co|com|k12|net|org",vn:"ac|biz|com|edu|gov|health|info|int|name|net|org|pro",ye:"co|com|gov|ltd|me|net|org|plc",yu:"ac|co|edu|gov|org",za:"ac|agric|alt|bourse|city|co|cybernet|db|edu|gov|grondar|iaccess|imt|inca|landesign|law|mil|net|ngo|nis|nom|olivetti|org|pix|school|tm|web",zm:"ac|co|com|edu|gov|net|org|sch"},has_expression:null,is_expression:null,has:function(e){return!!e.match(r.has_expression)},is:function(e){return!!e.match(r.is_expression)},get:function(e){return(e=e.match(r.has_expression))&&e[1]||null},noConflict:function(){e.SecondLevelDomains===this&&(e.SecondLevelDomains=t);return this},init:function(){var e="",t;for(t in r.list)n.call(r.list,t)&&(e+="|("+("("+r.list[t]+")."+t)+")");r.has_expression=RegExp("\\.("+e.substr(1)+")$","i");r.is_expression=RegExp("^("+e.substr(1)+")$","i")}};r.init();return r});(function(e,t){"object"==typeof exports?module.exports=t(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"==typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],t):e.URI=t(e.punycode,e.IPv6,e.SecondLevelDomains,e)})(this,function(e,t,n,r){function i(e,t){if(this instanceof i){void 0===e&&(e="undefined"!=typeof location?location.href+"":"");this.href(e);return void 0!==t?this.absoluteTo(t):this}return new i(e,t)}function s(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function o(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function u(e){return"Array"===o(e)}function a(e,t){var n,r;if(u(t)){n=0;for(r=t.length;n<r;n++)if(!a(e,t[n]))return!1;return!0}var i=o(t);n=0;for(r=e.length;n<r;n++)if("RegExp"===i){if("string"==typeof e[n]&&e[n].match(t))return!0}else if(e[n]===t)return!0;return!1}function f(e,t){if(!u(e)||!u(t)||e.length!==t.length)return!1;e.sort();t.sort();for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function l(e){return escape(e)}function c(e){return encodeURIComponent(e).replace(/[!'()*]/g,l).replace(/\*/g,"%2A")}var h=r&&r.URI,p=i.prototype,d=Object.prototype.hasOwnProperty;i._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:i.duplicateQueryParameters,escapeQuerySpace:i.escapeQuerySpace}};i.duplicateQueryParameters=!1;i.escapeQuerySpace=!0;i.protocol_expression=/^[a-z][a-z0-9-+-]*$/i;i.idn_expression=/[^a-z0-9\.-]/i;i.punycode_expression=/(xn--)/i;i.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;i.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;i.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))/ig;i.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"};i.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/;i.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src"};i.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();return"input"===t&&"image"!==e.type?void 0:i.domAttributes[t]}};i.encode=c;i.decode=decodeURIComponent;i.iso8859=function(){i.encode=escape;i.decode=unescape};i.unicode=function(){i.encode=c;i.decode=decodeURIComponent};i.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}}};i.encodeQuery=function(e,t){var n=i.encode(e+"");return t?n.replace(/%20/g,"+"):n};i.decodeQuery=function(e,t){e+="";try{return i.decode(t?e.replace(/\+/g,"%20"):e)}catch(n){return e}};i.recodePath=function(e){e=(e+"").split("/");for(var t=0,n=e.length;t<n;t++)e[t]=i.encodePathSegment(i.decode(e[t]));return e.join("/")};i.decodePath=function(e){e=(e+"").split("/");for(var t=0,n=e.length;t<n;t++)e[t]=i.decodePathSegment(e[t]);return e.join("/")};var v={encode:"encode",decode:"decode"},m,g=function(e,t){return function(n){return i[t](n+"").replace(i.characters[e][t].expression,function(n){return i.characters[e][t].map[n]})}};for(m in v)i[m+"PathSegment"]=g("pathname",v[m]);i.encodeReserved=g("reserved","encode");i.parse=function(e,t){var n;t||(t={});n=e.indexOf("#");-1<n&&(t.fragment=e.substring(n+1)||null,e=e.substring(0,n));n=e.indexOf("?");-1<n&&(t.query=e.substring(n+1)||null,e=e.substring(0,n));"//"===e.substring(0,2)?(t.protocol=null,e=e.substring(2),e=i.parseAuthority(e,t)):(n=e.indexOf(":"),-1<n&&(t.protocol=e.substring(0,n)||null,t.protocol&&!t.protocol.match(i.protocol_expression)?t.protocol=void 0:"file"===t.protocol?e=e.substring(n+3):"//"===e.substring(n+1,n+3)?(e=e.substring(n+3),e=i.parseAuthority(e,t)):(e=e.substring(n+1),t.urn=!0)));t.path=e;return t};i.parseHost=function(e,t){var n=e.indexOf("/"),r;-1===n&&(n=e.length);"["===e.charAt(0)?(r=e.indexOf("]"),t.hostname=e.substring(1,r)||null,t.port=e.substring(r+2,n)||null):e.indexOf(":")!==e.lastIndexOf(":")?(t.hostname=e.substring(0,n)||null,t.port=null):(r=e.substring(0,n).split(":"),t.hostname=r[0]||null,t.port=r[1]||null);t.hostname&&"/"!==e.substring(n).charAt(0)&&(n++,e="/"+e);return e.substring(n)||"/"};i.parseAuthority=function(e,t){e=i.parseUserinfo(e,t);return i.parseHost(e,t)};i.parseUserinfo=function(e,t){var n=e.indexOf("/"),r=-1<n?e.lastIndexOf("@",n):e.indexOf("@");-1<r&&(-1===n||r<n)?(n=e.substring(0,r).split(":"),t.username=n[0]?i.decode(n[0]):null,n.shift(),t.password=n[0]?i.decode(n.join(":")):null,e=e.substring(r+1)):(t.username=null,t.password=null);return e};i.parseQuery=function(e,t){if(!e)return{};e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"");if(!e)return{};for(var n={},r=e.split("&"),s=r.length,o,u,a=0;a<s;a++)o=r[a].split("="),u=i.decodeQuery(o.shift(),t),o=o.length?i.decodeQuery(o.join("="),t):null,n[u]?("string"==typeof n[u]&&(n[u]=[n[u]]),n[u].push(o)):n[u]=o;return n};i.build=function(e){var t="";e.protocol&&(t+=e.protocol+":");e.urn||!t&&!e.hostname||(t+="//");t+=i.buildAuthority(e)||"";"string"==typeof e.path&&("/"!==e.path.charAt(0)&&"string"==typeof e.hostname&&(t+="/"),t+=e.path);"string"==typeof e.query&&e.query&&(t+="?"+e.query);"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment);return t};i.buildHost=function(e){var t="";if(!e.hostname)return"";i.ip6_expression.test(e.hostname)?t=e.port?t+("["+e.hostname+"]:"+e.port):t+e.hostname:(t+=e.hostname,e.port&&(t+=":"+e.port));return t};i.buildAuthority=function(e){return i.buildUserinfo(e)+i.buildHost(e)};i.buildUserinfo=function(e){var t="";e.username&&(t+=i.encode(e.username),e.password&&(t+=":"+i.encode(e.password)),t+="@");return t};i.buildQuery=function(e,t,n){var r="",s,o,a,f;for(o in e)if(d.call(e,o)&&o)if(u(e[o]))for(s={},a=0,f=e[o].length;a<f;a++)void 0!==e[o][a]&&void 0===s[e[o][a]+""]&&(r+="&"+i.buildQueryParameter(o,e[o][a],n),!0!==t&&(s[e[o][a]+""]=!0));else void 0!==e[o]&&(r+="&"+i.buildQueryParameter(o,e[o],n));return r.substring(1)};i.buildQueryParameter=function(e,t,n){return i.encodeQuery(e,n)+(null!==t?"="+i.encodeQuery(t,n):"")};i.addQuery=function(e,t,n){if("object"==typeof t)for(var r in t)d.call(t,r)&&i.addQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");void 0===e[t]?e[t]=n:("string"==typeof e[t]&&(e[t]=[e[t]]),u(n)||(n=[n]),e[t]=e[t].concat(n))}};i.removeQuery=function(e,t,n){var r;if(u(t))for(n=0,r=t.length;n<r;n++)e[t[n]]=void 0;else if("object"==typeof t)for(r in t)d.call(t,r)&&i.removeQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the first parameter");if(void 0!==n){if(e[t]===n)e[t]=void 0;else if(u(e[t])){r=e[t];var s={},o,a;if(u(n))for(o=0,a=n.length;o<a;o++)s[n[o]]=!0;else s[n]=!0;o=0;for(a=r.length;o<a;o++)void 0!==s[r[o]]&&(r.splice(o,1),a--,o--);e[t]=r}}else e[t]=void 0}};i.hasQuery=function(e,t,n,r){if("object"==typeof t){for(var s in t)if(d.call(t,s)&&!i.hasQuery(e,s,t[s]))return!1;return!0}if("string"!=typeof t)throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter");switch(o(n)){case"Undefined":return t in e;case"Boolean":return e=Boolean(u(e[t])?e[t].length:e[t]),n===e;case"Function":return!!n(e[t],t,e);case"Array":return u(e[t])?(r?a:f)(e[t],n):!1;case"RegExp":return u(e[t])?r?a(e[t],n):!1:Boolean(e[t]&&e[t].match(n));case"Number":n=String(n);case"String":return u(e[t])?r?a(e[t],n):!1:e[t]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}};i.commonPath=function(e,t){var n=Math.min(e.length,t.length),r;for(r=0;r<n;r++)if(e.charAt(r)!==t.charAt(r)){r--;break}if(1>r)return e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"";if("/"!==e.charAt(r)||"/"!==t.charAt(r))r=e.substring(0,r).lastIndexOf("/");return e.substring(0,r+1)};i.withinString=function(e,t){return e.replace(i.find_uri_expression,t)};i.ensureValidHostname=function(t){if(t.match(i.invalid_hostname_characters)){if(!e)throw new TypeError("Hostname '"+t+"' contains characters other than [A-Z0-9.-] and Punycode.js is not available");if(e.toASCII(t).match(i.invalid_hostname_characters))throw new TypeError("Hostname '"+t+"' contains characters other than [A-Z0-9.-]")}};i.noConflict=function(e){if(e)return e={URI:this.noConflict()},URITemplate&&"function"==typeof URITemplate.noConflict&&(e.URITemplate=URITemplate.noConflict()),t&&"function"==typeof t.noConflict&&(e.IPv6=t.noConflict()),SecondLevelDomains&&"function"==typeof SecondLevelDomains.noConflict&&(e.SecondLevelDomains=SecondLevelDomains.noConflict()),e;r.URI===this&&(r.URI=h);return this};p.build=function(e){if(!0===e)this._deferred_build=!0;else if(void 0===e||this._deferred_build)this._string=i.build(this._parts),this._deferred_build=!1;return this};p.clone=function(){return new i(this)};p.valueOf=p.toString=function(){return this.build(!1)._string};v={protocol:"protocol",username:"username",password:"password",hostname:"hostname",port:"port"};g=function(e){return function(t,n){if(void 0===t)return this._parts[e]||"";this._parts[e]=t||null;this.build(!n);return this}};for(m in v)p[m]=g(v[m]);v={query:"?",fragment:"#"};g=function(e,t){return function(n,r){if(void 0===n)return this._parts[e]||"";null!==n&&(n+="",n.charAt(0)===t&&(n=n.substring(1)));this._parts[e]=n;this.build(!r);return this}};for(m in v)p[m]=g(m,v[m]);v={search:["?","query"],hash:["#","fragment"]};g=function(e,t){return function(n,r){var i=this[e](n,r);return"string"==typeof i&&i.length?t+i:i}};for(m in v)p[m]=g(v[m][1],v[m][0]);p.pathname=function(e,t){if(void 0===e||!0===e){var n=this._parts.path||(this._parts.hostname?"/":"");return e?i.decodePath(n):n}this._parts.path=e?i.recodePath(e):"/";this.build(!t);return this};p.path=p.pathname;p.href=function(e,t){var n;if(void 0===e)return this.toString();this._string="";this._parts=i._parts();var r=e instanceof i,s="object"==typeof e&&(e.hostname||e.path||e.pathname);e.nodeName&&(s=i.getDomAttribute(e),e=e[s]||"",s=!1);!r&&s&&void 0!==e.pathname&&(e=e.toString());if("string"==typeof e)this._parts=i.parse(e,this._parts);else{if(!r&&!s)throw new TypeError("invalid input");for(n in r=r?e._parts:e,r)d.call(this._parts,n)&&(this._parts[n]=r[n])}this.build(!t);return this};p.is=function(e){var t=!1,r=!1,s=!1,o=!1,u=!1,a=!1,f=!1,l=!this._parts.urn;this._parts.hostname&&(l=!1,r=i.ip4_expression.test(this._parts.hostname),s=i.ip6_expression.test(this._parts.hostname),t=r||s,u=(o=!t)&&n&&n.has(this._parts.hostname),a=o&&i.idn_expression.test(this._parts.hostname),f=o&&i.punycode_expression.test(this._parts.hostname));switch(e.toLowerCase()){case"relative":return l;case"absolute":return!l;case"domain":case"name":return o;case"sld":return u;case"ip":return t;case"ip4":case"ipv4":case"inet4":return r;case"ip6":case"ipv6":case"inet6":return s;case"idn":return a;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return f}return null};var y=p.protocol,b=p.port,w=p.hostname;p.protocol=function(e,t){if(void 0!==e&&e&&(e=e.replace(/:(\/\/)?$/,""),e.match(/[^a-zA-z0-9\.+-]/)))throw new TypeError("Protocol '"+e+"' contains characters other than [A-Z0-9.+-]");return y.call(this,e,t)};p.scheme=p.protocol;p.port=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e&&(0===e&&(e=null),e&&(e+="",":"===e.charAt(0)&&(e=e.substring(1)),e.match(/[^0-9]/))))throw new TypeError("Port '"+e+"' contains characters other than [0-9]");return b.call(this,e,t)};p.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var n={};i.parseHost(e,n);e=n.hostname}return w.call(this,e,t)};p.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildHost(this._parts):"";i.parseHost(e,this._parts);this.build(!t);return this};p.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?i.buildAuthority(this._parts):"";i.parseAuthority(e,this._parts);this.build(!t);return this};p.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.username)return"";var n=i.buildUserinfo(this._parts);return n.substring(0,n.length-1)}"@"!==e[e.length-1]&&(e+="@");i.parseUserinfo(e,this._parts);this.build(!t);return this};p.resource=function(e,t){var n;if(void 0===e)return this.path()+this.search()+this.hash();n=i.parse(e);this._parts.path=n.path;this._parts.query=n.query;this._parts.fragment=n.fragment;this.build(!t);return this};p.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,n)||""}n=this._parts.hostname.length-this.domain().length;n=this._parts.hostname.substring(0,n);n=RegExp("^"+s(n));e&&"."!==e.charAt(e.length-1)&&(e+=".");e&&i.ensureValidHostname(e);this._parts.hostname=this._parts.hostname.replace(n,e);this.build(!t);return this};p.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;"boolean"==typeof e&&(t=e,e=void 0);if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.match(/\./g);if(n&&2>n.length)return this._parts.hostname;n=this._parts.hostname.length-this.tld(t).length-1;n=this._parts.hostname.lastIndexOf(".",n-1)+1;return this._parts.hostname.substring(n)||""}if(!e)throw new TypeError("cannot set domain empty");i.ensureValidHostname(e);!this._parts.hostname||this.is("IP")?this._parts.hostname=e:(n=RegExp(s(this.domain())+"$"),this._parts.hostname=this._parts.hostname.replace(n,e));this.build(!t);return this};p.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;"boolean"==typeof e&&(t=e,e=void 0);if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.lastIndexOf("."),r=this._parts.hostname.substring(r+1);return!0!==t&&n&&n.list[r.toLowerCase()]?n.get(this._parts.hostname)||r:r}if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!n||!n.is(e))throw new TypeError("TLD '"+e+"' contains characters other than [A-Z0-9]");r=RegExp(s(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(r,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");r=RegExp(s(this.tld())+"$");this._parts.hostname=this._parts.hostname.replace(r,e)}this.build(!t);return this};p.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var n=this._parts.path.length-this.filename().length-1,n=this._parts.path.substring(0,n)||(this._parts.hostname?"/":"");return e?i.decodePath(n):n}n=this._parts.path.length-this.filename().length;n=this._parts.path.substring(0,n);n=RegExp("^"+s(n));this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e));e&&"/"!==e.charAt(e.length-1)&&(e+="/");e=i.recodePath(e);this._parts.path=this._parts.path.replace(n,e);this.build(!t);return this};p.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var n=this._parts.path.lastIndexOf("/"),n=this._parts.path.substring(n+1);return e?i.decodePathSegment(n):n}n=!1;"/"===e.charAt(0)&&(e=e.substring(1));e.match(/\.?\//)&&(n=!0);var r=RegExp(s(this.filename())+"$");e=i.recodePath(e);this._parts.path=this._parts.path.replace(r,e);n?this.normalizePath(t):this.build(!t);return this};p.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var n=this.filename(),r=n.lastIndexOf(".");if(-1===r)return"";n=n.substring(r+1);n=/^[a-z0-9%]+$/i.test(n)?n:"";return e?i.decodePathSegment(n):n}"."===e.charAt(0)&&(e=e.substring(1));if(n=this.suffix())r=e?RegExp(s(n)+"$"):RegExp(s("."+n)+"$");else{if(!e)return this;this._parts.path+="."+i.recodePath(e)}r&&(e=i.recodePath(e),this._parts.path=this._parts.path.replace(r,e));this.build(!t);return this};p.segment=function(e,t,n){var r=this._parts.urn?":":"/",i=this.path(),s="/"===i.substring(0,1),i=i.split(r);void 0!==e&&"number"!=typeof e&&(n=t,t=e,e=void 0);if(void 0!==e&&"number"!=typeof e)throw Error("Bad segment '"+e+"', must be 0-based integer");s&&i.shift();0>e&&(e=Math.max(i.length+e,0));if(void 0===t)return void 0===e?i:i[e];if(null===e||void 0===i[e]){if(u(t)){i=[];e=0;for(var o=t.length;e<o;e++)if(t[e].length||i.length&&i[i.length-1].length)i.length&&!i[i.length-1].length&&i.pop(),i.push(t[e])}else if(t||"string"==typeof t)""===i[i.length-1]?i[i.length-1]=t:i.push(t)}else t||"string"==typeof t&&t.length?i[e]=t:i.splice(e,1);s&&i.unshift("");return this.path(i.join(r),n)};p.segmentCoded=function(e,t,n){var r,s;"number"!=typeof e&&(n=t,t=e,e=void 0);if(void 0===t){e=this.segment(e,t,n);if(u(e))for(r=0,s=e.length;r<s;r++)e[r]=i.decode(e[r]);else e=void 0!==e?i.decode(e):void 0;return e}if(u(t))for(r=0,s=t.length;r<s;r++)t[r]=i.decode(t[r]);else t="string"==typeof t?i.encode(t):t;return this.segment(e,t,n)};var E=p.query;p.query=function(e,t){if(!0===e)return i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var n=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace),r=e.call(this,n);this._parts.query=i.buildQuery(r||n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);this.build(!t);return this}return void 0!==e&&"string"!=typeof e?(this._parts.query=i.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):E.call(this,e,t)};p.setQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("object"==typeof e)for(var s in e)d.call(e,s)&&(r[s]=e[s]);else{if("string"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");r[e]=void 0!==t?t:null}this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!=typeof e&&(n=t);this.build(!n);return this};p.addQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);i.addQuery(r,e,void 0===t?null:t);this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!=typeof e&&(n=t);this.build(!n);return this};p.removeQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);i.removeQuery(r,e,t);this._parts.query=i.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace);"string"!=typeof e&&(n=t);this.build(!n);return this};p.hasQuery=function(e,t,n){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.hasQuery(r,e,t,n)};p.setSearch=p.setQuery;p.addSearch=p.addQuery;p.removeSearch=p.removeQuery;p.hasSearch=p.hasQuery;p.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()};p.normalizeProtocol=function(e){"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e));return this};p.normalizeHostname=function(n){this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!n));return this};p.normalizePort=function(e){"string"==typeof this._parts.protocol&&this._parts.port===i.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e));return this};p.normalizePath=function(e){if(this.
_parts.urn||!this._parts.path||"/"===this._parts.path)return this;var t,n=this._parts.path,r,s;"/"!==n.charAt(0)&&(t=!0,n="/"+n);for(n=n.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/");;){r=n.indexOf("/../");if(-1===r)break;if(0===r){n=n.substring(3);break}s=n.substring(0,r).lastIndexOf("/");-1===s&&(s=r);n=n.substring(0,s)+n.substring(r+3)}t&&this.is("relative")&&(n=n.substring(1));n=i.recodePath(n);this._parts.path=n;this.build(!e);return this};p.normalizePathname=p.normalizePath;p.normalizeQuery=function(e){"string"==typeof this._parts.query&&(this._parts.query.length?this.query(i.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e));return this};p.normalizeFragment=function(e){this._parts.fragment||(this._parts.fragment=null,this.build(!e));return this};p.normalizeSearch=p.normalizeQuery;p.normalizeHash=p.normalizeFragment;p.iso8859=function(){var e=i.encode,t=i.decode;i.encode=escape;i.decode=decodeURIComponent;this.normalize();i.encode=e;i.decode=t;return this};p.unicode=function(){var e=i.encode,t=i.decode;i.encode=c;i.decode=unescape;this.normalize();i.encode=e;i.decode=t;return this};p.readable=function(){var t=this.clone();t.username("").password("").normalize();var n="";t._parts.protocol&&(n+=t._parts.protocol+"://");t._parts.hostname&&(t.is("punycode")&&e?(n+=e.toUnicode(t._parts.hostname),t._parts.port&&(n+=":"+t._parts.port)):n+=t.host());t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(n+="/");n+=t.path(!0);if(t._parts.query){for(var r="",s=0,o=t._parts.query.split("&"),u=o.length;s<u;s++){var a=(o[s]||"").split("="),r=r+("&"+i.decodeQuery(a[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"));void 0!==a[1]&&(r+="="+i.decodeQuery(a[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}n+="?"+r.substring(1)}return n+=i.decodeQuery(t.hash(),!0)};p.absoluteTo=function(e){var t=this.clone(),n=["protocol","username","password","hostname","port"],r,s;if(this._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");e instanceof i||(e=new i(e));t._parts.protocol||(t._parts.protocol=e._parts.protocol);if(this._parts.hostname)return t;for(r=0;s=n[r];r++)t._parts[s]=e._parts[s];n=["query","path"];for(r=0;s=n[r];r++)!t._parts[s]&&e._parts[s]&&(t._parts[s]=e._parts[s]);"/"!==t.path().charAt(0)&&(e=e.directory(),t._parts.path=(e?e+"/":"")+t._parts.path,t.normalizePath());t.build();return t};p.relativeTo=function(e){var t=this.clone().normalize(),n,r,s,o;if(t._parts.urn)throw Error("URNs do not have any generally defined hierarchical components");e=(new i(e)).normalize();n=t._parts;r=e._parts;s=t.path();o=e.path();if("/"!==s.charAt(0))throw Error("URI is already relative");if("/"!==o.charAt(0))throw Error("Cannot calculate a URI relative to another relative URI");n.protocol===r.protocol&&(n.protocol=null);if(n.username!==r.username||n.password!==r.password||null!==n.protocol||null!==n.username||null!==n.password||n.hostname!==r.hostname||n.port!==r.port)return t.build();n.hostname=null,n.port=null;if(s===o)return n.path="",t.build();e=i.commonPath(t.path(),e.path());if(!e)return t.build();r=r.path.substring(e.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");n.path=r+n.path.substring(e.length);return t.build()};p.equals=function(e){var t=this.clone();e=new i(e);var n={},r={},s={},o;t.normalize();e.normalize();if(t.toString()===e.toString())return!0;n=t.query();r=e.query();t.query("");e.query("");if(t.toString()!==e.toString()||n.length!==r.length)return!1;n=i.parseQuery(n,this._parts.escapeQuerySpace);r=i.parseQuery(r,this._parts.escapeQuerySpace);for(o in n)if(d.call(n,o)){if(!u(n[o])){if(n[o]!==r[o])return!1}else if(!f(n[o],r[o]))return!1;s[o]=!0}for(o in r)if(d.call(r,o)&&!s[o])return!1;return!0};p.duplicateQueryParameters=function(e){this._parts.duplicateQueryParameters=!!e;return this};p.escapeQuerySpace=function(e){this._parts.escapeQuerySpace=!!e;return this};return i});(function(e,t){"object"==typeof exports?module.exports=t(require("./URI")):"function"==typeof define&&define.amd?define(["./URI"],t):e.URITemplate=t(e.URI,e)})(this,function(e,t){function n(e){if(n._cache[e])return n._cache[e];if(this instanceof n){this.expression=e;n._cache[e]=this;return this}return new n(e)}function r(e){this.data=e;this.cache={}}var i=t&&t.URITemplate,s=Object.prototype.hasOwnProperty,o=n.prototype,u={"":{prefix:"",separator:",",named:!1,empty_name_separator:!1,encode:"encode"},"+":{prefix:"",separator:",",named:!1,empty_name_separator:!1,encode:"encodeReserved"},"#":{prefix:"#",separator:",",named:!1,empty_name_separator:!1,encode:"encodeReserved"},".":{prefix:".",separator:".",named:!1,empty_name_separator:!1,encode:"encode"},"/":{prefix:"/",separator:"/",named:!1,empty_name_separator:!1,encode:"encode"},";":{prefix:";",separator:";",named:!0,empty_name_separator:!1,encode:"encode"},"?":{prefix:"?",separator:"&",named:!0,empty_name_separator:!0,encode:"encode"},"&":{prefix:"&",separator:"&",named:!0,empty_name_separator:!0,encode:"encode"}};n._cache={};n.EXPRESSION_PATTERN=/\{([^a-zA-Z0-9%_]?)([^\}]+)(\}|$)/g;n.VARIABLE_PATTERN=/^([^*:]+)((\*)|:(\d+))?$/;n.VARIABLE_NAME_PATTERN=/[^a-zA-Z0-9%_]/;n.expand=function(e,t){var r=u[e.operator],i=r.named?"Named":"Unnamed",s=e.variables,o=[],a,f,l;for(l=0;f=s[l];l++)a=t.get(f.name),a.val.length?o.push(n["expand"+i](a,r,f.explode,f.explode&&r.separator||",",f.maxlength,f.name)):a.type&&o.push("");return o.length?r.prefix+o.join(r.separator):""};n.expandNamed=function(t,n,r,i,s,o){var u="",a=n.encode;n=n.empty_name_separator;var l=!t[a].length,c=2===t.type?"":e[a](o),h,p,d;p=0;for(d=t.val.length;p<d;p++)s?(h=e[a](t.val[p][1].substring(0,s)),2===t.type&&(c=e[a](t.val[p][0].substring(0,s)))):l?(h=e[a](t.val[p][1]),2===t.type?(c=e[a](t.val[p][0]),t[a].push([c,h])):t[a].push([void 0,h])):(h=t[a][p][1],2===t.type&&(c=t[a][p][0])),u&&(u+=i),r?u+=c+(n||h?"=":"")+h:(p||(u+=e[a](o)+(n||h?"=":"")),2===t.type&&(u+=c+","),u+=h);return u};n.expandUnnamed=function(t,n,r,i,s,o){o="";var u=n.encode;n=n.empty_name_separator;var a=!t[u].length,l,c,h,p;h=0;for(p=t.val.length;h<p;h++)s?c=e[u](t.val[h][1].substring(0,s)):a?(c=e[u](t.val[h][1]),t[u].push([2===t.type?e[u](t.val[h][0]):void 0,c])):c=t[u][h][1],o&&(o+=i),2===t.type&&(l=s?e[u](t.val[h][0].substring(0,s)):t[u][h][0],o+=l,o=r?o+(n||c?"=":""):o+","),o+=c;return o};n.noConflict=function(){t.URITemplate===n&&(t.URITemplate=i);return n};o.expand=function(e){var t="";this.parts&&this.parts.length||this.parse();e instanceof r||(e=new r(e));for(var i=0,s=this.parts.length;i<s;i++)t+="string"==typeof this.parts[i]?this.parts[i]:n.expand(this.parts[i],e);return t};o.parse=function(){var e=this.expression,t=n.EXPRESSION_PATTERN,r=n.VARIABLE_PATTERN,i=n.VARIABLE_NAME_PATTERN,s=[],o=0,a,f,l;for(t.lastIndex=0;;){f=t.exec(e);if(null===f){s.push(e.substring(o));break}s.push(e.substring(o,f.index)),o=f.index+f[0].length;if(!u[f[1]])throw Error('Unknown Operator "'+f[1]+'" in "'+f[0]+'"');if(!f[3])throw Error('Unclosed Expression "'+f[0]+'"');a=f[2].split(",");for(var c=0,p=a.length;c<p;c++){l=a[c].match(r);if(null===l)throw Error('Invalid Variable "'+a[c]+'" in "'+f[0]+'"');if(l[1].match(i))throw Error('Invalid Variable Name "'+l[1]+'" in "'+f[0]+'"');a[c]={name:l[1],explode:!!l[3],maxlength:l[4]&&parseInt(l[4],10)}}if(!a.length)throw Error('Expression Missing Variable(s) "'+f[0]+'"');s.push({expression:f[0],operator:f[1],variables:a})}s.length||s.push(e);this.parts=s;return this};r.prototype.get=function(e){var t=this.data,n={type:0,val:[],encode:[],encodeReserved:[]},r;if(void 0!==this.cache[e])return this.cache[e];this.cache[e]=n;t="[object Function]"===String(Object.prototype.toString.call(t))?t(e):"[object Function]"===String(Object.prototype.toString.call(t[e]))?t[e](e):t[e];if(void 0!==t&&null!==t)if("[object Array]"===String(Object.prototype.toString.call(t))){r=0;for(e=t.length;r<e;r++)void 0!==t[r]&&null!==t[r]&&n.val.push([void 0,String(t[r])]);n.val.length&&(n.type=3)}else if("[object Object]"===String(Object.prototype.toString.call(t))){for(r in t)s.call(t,r)&&void 0!==t[r]&&null!==t[r]&&n.val.push([r,String(t[r])]);n.val.length&&(n.type=2)}else n.type=1,n.val.push([void 0,String(t)]);return n};e.expand=function(t,r){var i=(new n(t)).expand(r);return new e(i)};return n});(function(e,t){if(typeof exports=="object"&&exports)t(exports);else{var n={};t(n);typeof define=="function"&&define.amd?define(n):e.Mustache=n}})(this,function(e){function a(e,t){return u.call(e,t)}function f(e){return!a(r,e)}function h(e){return typeof e=="function"}function p(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function v(e){return String(e).replace(/[&<>"'\/]/g,function(e){return d[e]})}function m(e){this.string=e;this.tail=e;this.pos=0}function g(e,t){this.view=e==null?{}:e;this.parent=t;this._cache={".":this.view}}function y(){this.clearCache()}function b(t,n,r,i){function o(e){return n.render(e,r)}var s="",u,a,f;for(var l=0,p=t.length;l<p;++l){u=t[l];a=u[1];switch(u[0]){case"#":f=r.lookup(a);if(typeof f=="object"||typeof f=="string")if(c(f))for(var d=0,v=f.length;d<v;++d)s+=b(u[4],n,r.push(f[d]),i);else f&&(s+=b(u[4],n,r.push(f),i));else if(h(f)){var m=i==null?null:i.slice(u[3],u[5]);f=f.call(r.view,m,o);f!=null&&(s+=f)}else f&&(s+=b(u[4],n,r,i));break;case"^":f=r.lookup(a);if(!f||c(f)&&f.length===0)s+=b(u[4],n,r,i);break;case">":f=n.getPartial(a);h(f)&&(s+=f(r));break;case"&":f=r.lookup(a);f!=null&&(s+=f);break;case"name":f=r.lookup(a);f!=null&&(s+=e.escape(f));break;case"text":s+=a}}return s}function w(e){var t=[],n=t,r=[],i;for(var s=0,o=e.length;s<o;++s){i=e[s];switch(i[0]){case"#":case"^":r.push(i);n.push(i);n=i[4]=[];break;case"/":var u=r.pop();u[5]=i[2];n=r.length>0?r[r.length-1][4]:t;break;default:n.push(i)}}return t}function E(e){var t=[],n,r;for(var i=0,s=e.length;i<s;++i){n=e[i];if(n)if(n[0]==="text"&&r&&r[0]==="text"){r[1]+=n[1];r[3]=n[3]}else{r=n;t.push(n)}}return t}function S(e){return[new RegExp(p(e[0])+"\\s*"),new RegExp("\\s*"+p(e[1]))]}function x(r,u){function y(){if(v&&!g)while(d.length)delete h[d.pop()];else d=[];v=!1;g=!1}r=r||"";u=u||e.tags;typeof u=="string"&&(u=u.split(n));if(u.length!==2)throw new Error("Invalid tags: "+u.join(", "));var a=S(u),l=new m(r),c=[],h=[],d=[],v=!1,g=!1,b,x,T,N,C,k;while(!l.eos()){b=l.pos;T=l.scanUntil(a[0]);if(T)for(var L=0,A=T.length;L<A;++L){N=T.charAt(L);f(N)?d.push(h.length):g=!0;h.push(["text",N,b,b+1]);b+=1;N=="\n"&&y()}if(!l.scan(a[0]))break;v=!0;x=l.scan(o)||"name";l.scan(t);if(x==="="){T=l.scanUntil(i);l.scan(i);l.scanUntil(a[1])}else if(x==="{"){T=l.scanUntil(new RegExp("\\s*"+p("}"+u[1])));l.scan(s);l.scanUntil(a[1]);x="&"}else T=l.scanUntil(a[1]);if(!l.scan(a[1]))throw new Error("Unclosed tag at "+l.pos);C=[x,T,b,l.pos];h.push(C);if(x==="#"||x==="^")c.push(C);else if(x==="/"){k=c.pop();if(!k)throw new Error('Unopened section "'+T+'" at '+b);if(k[1]!==T)throw new Error('Unclosed section "'+k[1]+'" at '+b)}else if(x==="name"||x==="{"||x==="&")g=!0;else if(x==="="){u=T.split(n);if(u.length!==2)throw new Error("Invalid tags at "+b+": "+u.join(", "));a=S(u)}}k=c.pop();if(k)throw new Error('Unclosed section "'+k[1]+'" at '+l.pos);return w(E(h))}var t=/\s*/,n=/\s+/,r=/\S/,i=/\s*=/,s=/\s*\}/,o=/#|\^|\/|>|\{|&|=|!/,u=RegExp.prototype.test,l=Object.prototype.toString,c=Array.isArray||function(e){return l.call(e)==="[object Array]"},d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};m.prototype.eos=function(){return this.tail===""};m.prototype.scan=function(e){var t=this.tail.match(e);if(t&&t.index===0){var n=t[0];this.tail=this.tail.substring(n.length);this.pos+=n.length;return n}return""};m.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail;this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t);this.tail=this.tail.substring(t)}this.pos+=n.length;return n};g.make=function(e){return e instanceof g?e:new g(e)};g.prototype.push=function(e){return new g(e,this)};g.prototype.lookup=function(e){var t;if(e in this._cache)t=this._cache[e];else{var n=this;while(n){if(e.indexOf(".")>0){t=n.view;var r=e.split("."),i=0;while(t!=null&&i<r.length)t=t[r[i++]]}else t=n.view[e];if(t!=null)break;n=n.parent}this._cache[e]=t}h(t)&&(t=t.call(this.view));return t};y.prototype.clearCache=function(){this._cache={};this._partialCache={}};y.prototype.compile=function(t,n){var r=this._cache[t];if(!r){var i=e.parse(t,n);r=this._cache[t]=this.compileTokens(i,t)}return r};y.prototype.compilePartial=function(e,t,n){var r=this.compile(t,n);this._partialCache[e]=r;return r};y.prototype.getPartial=function(e){!(e in this._partialCache)&&this._loadPartial&&this.compilePartial(e,this._loadPartial(e));return this._partialCache[e]};y.prototype.compileTokens=function(e,t){var n=this;return function(r,i){if(i)if(h(i))n._loadPartial=i;else for(var s in i)n.compilePartial(s,i[s]);return b(e,n,g.make(r),t)}};y.prototype.render=function(e,t,n){return this.compile(e)(t,n)};e.name="mustache.js";e.version="0.7.3";e.tags=["{{","}}"];e.Scanner=m;e.Context=g;e.Writer=y;e.parse=x;e.escape=v;var T=new y;e.clearCache=function(){return T.clearCache()};e.compile=function(e,t){return T.compile(e,t)};e.compilePartial=function(e,t,n){return T.compilePartial(e,t,n)};e.compileTokens=function(e,t){return T.compileTokens(e,t)};e.render=function(e,t,n){return T.render(e,t,n)};e.to_html=function(t,n,r,i){var s=e.render(t,n,r);if(!h(i))return s;i(s)}});var lunr=function(e){var t=new lunr.Index;return t.pipeline.add(lunr.stopWordFilter,lunr.stemmer),e&&e.call(t,t),t};lunr.version="0.4.3","undefined"!=typeof module&&(module.exports=lunr),lunr.utils={},lunr.utils.warn=function(e){return function(n){e.console&&console.warn&&console.warn(n)}}(this),lunr.utils.zeroFillArray=function(){var e=[0];return function(n){for(;n>e.length;)e=e.concat(e);return e.slice(0,n)}}(),lunr.EventEmitter=function(){this.events={}},lunr.EventEmitter.prototype.addListener=function(){var e=Array.prototype.slice.call(arguments),t=e.pop(),n=e;if("function"!=typeof t)throw new TypeError("last argument must be a function");n.forEach(function(e){this.hasHandler(e)||(this.events[e]=[]),this.events[e].push(t)},this)},lunr.EventEmitter.prototype.removeListener=function(e,t){if(this.hasHandler(e)){var n=this.events[e].indexOf(t);this.events[e].splice(n,1),this.events[e].length||delete this.events[e]}},lunr.EventEmitter.prototype.emit=function(e){if(this.hasHandler(e)){var t=Array.prototype.slice.call(arguments,1);this.events[e].forEach(function(e){e.apply(void 0,t)})}},lunr.EventEmitter.prototype.hasHandler=function(e){return e in this.events},lunr.tokenizer=function(e){if(!arguments.length||null==e||void 0==e)return[];if(Array.isArray(e))return e.map(function(e){return e.toLowerCase()});for(var t=(""+e).replace(/^\s+/,""),n=t.length-1;n>=0;n--)if(/\S/.test(t.charAt(n))){t=t.substring(0,n+1);break}return t.split(/\s+/).map(function(e){return e.replace(/^\W+/,"").replace(/\W+$/,"").toLowerCase()})},lunr.Pipeline=function(){this._stack=[]},lunr.Pipeline.registeredFunctions={},lunr.Pipeline.registerFunction=function(e,t){t in this.registeredFunctions&&lunr.utils.warn("Overwriting existing registered function: "+t),e.label=t,lunr.Pipeline.registeredFunctions[e.label]=e},lunr.Pipeline.warnIfFunctionNotRegistered=function(e){var t=e.label&&e.label in this.registeredFunctions;t||lunr.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",e)},lunr.Pipeline.load=function(e){var t=new lunr.Pipeline;return e.forEach(function(e){var n=lunr.Pipeline.registeredFunctions[e];if(!n)throw Error("Cannot load un-registered function: "+e);t.add(n)}),t},lunr.Pipeline.prototype.add=function(){var e=Array.prototype.slice.call(arguments);e.forEach(function(e){lunr.Pipeline.warnIfFunctionNotRegistered(e),this._stack.push(e)},this)},lunr.Pipeline.prototype.after=function(e,t){lunr.Pipeline.warnIfFunctionNotRegistered(t);var n=this._stack.indexOf(e)+1;this._stack.splice(n,0,t)},lunr.Pipeline.prototype.before=function(e,t){lunr.Pipeline.warnIfFunctionNotRegistered(t);var n=this._stack.indexOf(e);this._stack.splice(n,0,t)},lunr.Pipeline.prototype.remove=function(e){var t=this._stack.indexOf(e);this._stack.splice(t,1)},lunr.Pipeline.prototype.run=function(e){for(var t=[],n=e.length,r=this._stack.length,i=0;n>i;i++){for(var s=e[i],o=0;r>o&&(s=this._stack[o](s,i,e),void 0!==s);o++);void 0!==s&&t.push(s)}return t},lunr.Pipeline.prototype.toJSON=function(){return this._stack.map(function(e){return lunr.Pipeline.warnIfFunctionNotRegistered(e),e.label})},lunr.Vector=function(e){this.elements=e},lunr.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var e,t=0,n=this.elements,r=n.length,i=0;r>i;i++)e=n[i],t+=e*e;return this._magnitude=Math.sqrt(t)},lunr.Vector.prototype.dot=function(e){for(var t=this.elements,n=e.elements,r=t.length,i=0,s=0;r>s;s++)i+=t[s]*n[s];return i},lunr.Vector.prototype.similarity=function(e){return this.dot(e)/(this.magnitude()*e.magnitude())},lunr.Vector.prototype.toArray=function(){return this.elements},lunr.SortedSet=function(){this.length=0,this.elements=[]},lunr.SortedSet.load=function(e){var t=new this;return t.elements=e,t.length=e.length,t},lunr.SortedSet.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(e){~this.indexOf(e)||this.elements.splice(this.locationFor(e),0,e)},this),this.length=this.elements.length},lunr.SortedSet.prototype.toArray=function(){return this.elements.slice()},lunr.SortedSet.prototype.map=function(e,t){return this.elements.map(e,t)},lunr.SortedSet.prototype.forEach=function(e,t){return this.elements.forEach(e,t)},lunr.SortedSet.prototype.indexOf=function(e,t,n){var t=t||0,n=n||this.elements.length,r=n-t,i=t+Math.floor(r/2),s=this.elements[i];return 1>=r?s===e?i:-1:e>s?this.indexOf(e,i,n):s>e?this.indexOf(e,t,i):s===e?i:void 0},lunr.SortedSet.prototype.locationFor=function(e,t,n){var t=t||0,n=n||this.elements.length,r=n-t,i=t+Math.floor(r/2),s=this.elements[i];if(1>=r){if(s>e)return i;if(e>s)return i+1}return e>s?this.locationFor(e,i,n):s>e?this.locationFor(e,t,i):void 0},lunr.SortedSet.prototype.intersect=function(e){for(var t=new lunr.SortedSet,n=0,r=0,i=this.length,s=e.length,o=this.elements,u=e.elements;;){if(n>i-1||r>s-1)break;o[n]!==u[r]?o[n]<u[r]?n++:o[n]>u[r]&&r++:(t.add(o[n]),n++,r++)}return t},lunr.SortedSet.prototype.clone=function(){var e=new lunr.SortedSet;return e.elements=this.toArray(),e.length=e.elements.length,e},lunr.SortedSet.prototype.union=function(e){var t,n,r;return this.length>=e.length?(t=this,n=e):(t=e,n=this),r=t.clone(),r.add.apply(r,n.toArray()),r},lunr.SortedSet.prototype.toJSON=function(){return this.toArray()},lunr.Index=function(){this._fields=[],this._ref="id",this.pipeline=new lunr.Pipeline,this.documentStore=new lunr.Store,this.tokenStore=new lunr.TokenStore,this.corpusTokens=new lunr.SortedSet,this.eventEmitter=new lunr.EventEmitter,this._idfCache={},this.on("add","remove","update",function(){this._idfCache={}}.bind(this))},lunr.Index.prototype.on=function(){var e=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,e)},lunr.Index.prototype.off=function(e,t){return this.eventEmitter.removeListener(e,t)},lunr.Index.load=function(e){e.version!==lunr.version&&lunr.utils.warn("version mismatch: current "+lunr.version+" importing "+e.version);var t=new this;return t._fields=e.fields,t._ref=e.ref,t.documentStore=lunr.Store.load(e.documentStore),t.tokenStore=lunr.TokenStore.load(e.tokenStore),t.corpusTokens=lunr.SortedSet.load(e.corpusTokens),t.pipeline=lunr.Pipeline.load(e.pipeline),t},lunr.Index.prototype.field=function(e,t){var t=t||{},n={name:e,boost:t.boost||1};return this._fields.push(n),this},lunr.Index.prototype.ref=function(e){return this._ref=e,this},lunr.Index.prototype.add=function(e,t){var n={},r=new lunr.SortedSet,i=e[this._ref],t=void 0===t?!0:t;this._fields.forEach(function(t){var i=this.pipeline.run(lunr.tokenizer(e[t.name]));n[t.name]=i,lunr.SortedSet.prototype.add.apply(r,i)},this),this.documentStore.set(i,r),lunr.SortedSet.prototype.add.apply(this.corpusTokens,r.toArray());for(var s=0;r.length>s;s++){var o=r.elements[s],u=this._fields.reduce(function(e,t){var r=n[t.name].length;if(!r)return e;var i=n[t.name].filter(function(e){return e===o}).length;return e+i/r*t.boost},0);this.tokenStore.add(o,{ref:i,tf:u})}t&&this.eventEmitter.emit("add",e,this)},lunr.Index.prototype.remove=function(e,t){var n=e[this._ref],t=void 0===t?!0:t;if(this.documentStore.has(n)){var r=this.documentStore.get(n);this.documentStore.remove(n),r.forEach(function(e){this.tokenStore.remove(e,n)},this),t&&this.eventEmitter.emit("remove",e,this)}},lunr.Index.prototype.update=function(e,t){var t=void 0===t?!0:t;this.remove(e,!1),this.add(e,!1),t&&this.eventEmitter.emit("update",e,this)},lunr.Index.prototype.idf=function(e){if(this._idfCache[e])return this._idfCache[e];var t=this.tokenStore.count(e),n=1;return t>0&&(n=1+Math.log(this.tokenStore.length/t)),this._idfCache[e]=n},lunr.Index.prototype.search=function(e){var t=this.pipeline.run(lunr.tokenizer(e)),n=lunr.utils.zeroFillArray(this.corpusTokens.length),r=[],i=this._fields.reduce(function(e,t){return e+t.boost},0),s=t.some(function(e){return this.tokenStore.has(e)},this);if(!s)return[];t.forEach(function(e,t,s){var o=1/s.length*this._fields.length*i,u=this,a=this.tokenStore.expand(e).reduce(function(t,r){var i=u.corpusTokens.indexOf(r),s=u.idf(r),a=1,f=new lunr.SortedSet;if(r!==e){var c=Math.max(3,r.length-e.length);a=1/Math.log(c)}return i>-1&&(n[i]=o*s*a),Object.keys(u.tokenStore.get(r)).forEach(function(e){f.add(e)}),t.union(f)},new lunr.SortedSet);r.push(a)},this);var o=r.reduce(function(e,t){return e.intersect(t)}),u=new lunr.Vector(n);return o.map(function(e){return{ref:e,score:u.similarity(this.documentVector(e))}},this).sort(function(e,t){return t.score-e.score})},lunr.Index.prototype.documentVector=function(e){for(var t=this.documentStore.get(e),n=t.length,r=lunr.utils.zeroFillArray(this.corpusTokens.length),i=0;n>i;i++){var s=t.elements[i],o=this.tokenStore.get(s)[e].tf,u=this.idf(s);r[this.corpusTokens.indexOf(s)]=o*u}return new lunr.Vector(r)},lunr.Index.prototype.toJSON=function(){return{version:lunr.version,fields:this._fields,ref:this._ref,documentStore:this.documentStore.toJSON(),tokenStore:this.tokenStore.toJSON(),corpusTokens:this.corpusTokens.toJSON(),pipeline:this.pipeline.toJSON()}},lunr.Store=function(){this.store={},this.length=0},lunr.Store.load=function(e){var t=new this;return t.length=e.length,t.store=Object.keys(e.store).reduce(function(t,n){return t[n]=lunr.SortedSet.load(e.store[n]),t},{}),t},lunr.Store.prototype.set=function(e,t){this.store[e]=t,this.length=Object.keys(this.store).length},lunr.Store.prototype.get=function(e){return this.store[e]},lunr.Store.prototype.has=function(e){return e in this.store},lunr.Store.prototype.remove=function(e){this.has(e)&&(delete this.store[e],this.length--)},lunr.Store.prototype.toJSON=function(){return{store:this.store,length:this.length}},lunr.stemmer=function(){var e={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},t={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},n="[^aeiou]",r="[aeiouy]",i=n+"[^aeiouy]*",s=r+"[aeiou]*",o="^("+i+")?"+s+i,u="^("+i+")?"+s+i+"("+s+")?$",a="^("+i+")?"+s+i+s+i,f="^("+i+")?"+r;return function(n){var s,c,h,p,d,v,m;if(3>n.length)return n;if(h=n.substr(0,1),"y"==h&&(n=h.toUpperCase()+n.substr(1)),p=/^(.+?)(ss|i)es$/,d=/^(.+?)([^s])s$/,p.test(n)?n=n.replace(p,"$1$2"):d.test(n)&&(n=n.replace(d,"$1$2")),p=/^(.+?)eed$/,d=/^(.+?)(ed|ing)$/,p.test(n)){var g=p.exec(n);p=RegExp(o),p.test(g[1])&&(p=/.$/,n=n.replace(p,""))}else if(d.test(n)){var g=d.exec(n);s=g[1],d=RegExp(f),d.test(s)&&(n=s,d=/(at|bl|iz)$/,v=RegExp("([^aeiouylsz])\\1$"),m=RegExp("^"+i+r+"[^aeiouwxy]$"),d.test(n)?n+="e":v.test(n)?(p=/.$/,n=n.replace(p,"")):m.test(n)&&(n+="e"))}if(p=/^(.+?)y$/,p.test(n)){var g=p.exec(n);s=g[1],p=RegExp(f),p.test(s)&&(n=s+"i")}if(p=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,p.test(n)){var g=p.exec(n);s=g[1],c=g[2],p=RegExp(o),p.test(s)&&(n=s+e[c])}if(p=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,p.test(n)){var g=p.exec(n);s=g[1],c=g[2],p=RegExp(o),p.test(s)&&(n=s+t[c])}if(p=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,d=/^(.+?)(s|t)(ion)$/,p.test(n)){var g=p.exec(n);s=g[1],p=RegExp(a),p.test(s)&&(n=s)}else if(d.test(n)){var g=d.exec(n);s=g[1]+g[2],d=RegExp(a),d.test(s)&&(n=s)}if(p=/^(.+?)e$/,p.test(n)){var g=p.exec(n);s=g[1],p=RegExp(a),d=RegExp(u),v=RegExp("^"+i+r+"[^aeiouwxy]$"),(p.test(s)||d.test(s)&&!v.test(s))&&(n=s)}return p=/ll$/,d=RegExp(a),p.test(n)&&d.test(n)&&(p=/.$/,n=n.replace(p,"")),"y"==h&&(n=h.toLowerCase()+n.substr(1)),n}}(),lunr.Pipeline.registerFunction(lunr.stemmer,"stemmer"),lunr.stopWordFilter=function(e){return-1===lunr.stopWordFilter.stopWords.indexOf(e)?e:void 0},lunr.stopWordFilter.stopWords=new lunr.SortedSet,lunr.stopWordFilter.stopWords.length=119,lunr.stopWordFilter.stopWords.elements=["","a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"],lunr.Pipeline.registerFunction(lunr.stopWordFilter,"stopWordFilter"),lunr.TokenStore=function(){this.root={docs:{}},this.length=0},lunr.TokenStore.load=function(e){var t=new this;return t.root=e.root,t.length=e.length,t},lunr.TokenStore.prototype.add=function(e,t,n){var n=n||this.root,r=e[0],i=e.slice(1);return r in n||(n[r]={docs:{}}),0===i.length?(n[r].docs[t.ref]=t,this.length+=1,void 0):this.add(i,t,n[r])},lunr.TokenStore.prototype.has=function(e){if(!e)return!1;for(var t=this.root,n=0;e.length>n;n++){if(!t[e[n]])return!1;t=t[e[n]]}return!0},lunr.TokenStore.prototype.getNode=function(e){if(!e)return{};for(var t=this.root,n=0;e.length>n;n++){if(!t[e[n]])return{};t=t[e[n]]}return t},lunr.TokenStore.prototype.get=function(e,t){return this.getNode(e,t).docs||{}},lunr.TokenStore.prototype.count=function(e,t){return Object.keys(this.get(e,t)).length},lunr.TokenStore.prototype.remove=function(e,t){if(e){for(var n=this.root,r=0;e.length>r;r++){if(!(e[r]in n))return;n=n[e[r]]}delete n.docs[t]}},lunr.TokenStore.prototype.expand=function(e,t){var n=this.getNode(e),r=n.docs||{},t=t||[];return Object.keys(r).length&&t.push(e),Object.keys(n).forEach(function(n){"docs"!==n&&t.concat(this.expand(e+n,t))},this),t},lunr.TokenStore.prototype.toJSON=function(){return{root:this.root,length:this.length}};(function(e){var t=function(e){var t,n=Array.prototype.slice;return function(){var r=n.call(arguments),i=this;clearTimeout(t);t=setTimeout(function(){e.apply(i,r)},100)}},n=function(e){var t=e.match(/(\d+)/g);return new Date(t[0],t[1]-1,t[2])},r=function(){function r(t,n){this.$elem=t;this.$results=e(n.results),this.$entries=e(n.entries,this.$results),this.indexDataUrl=n.indexUrl;this.index=this.createIndex();this.template=this.compileTemplate(e(n.template));this.initialize()}r.prototype.initialize=function(){var e=this;this.loadIndexData(function(t){e.populateIndex(t);e.populateSearchFromQuery();e.bindKeypress()})};r.prototype.createIndex=function(){return lunr(function(){this.field("title",{boost:10});this.field("body");this.ref("id")})};r.prototype.compileTemplate=function(e){return Mustache.compile(e.text())};r.prototype.loadIndexData=function(t){e.getJSON(this.indexDataUrl,t)};r.prototype.populateIndex=function(t){var n=this.index;this.entries=e.map(t.entries,this.createEntry);e.each(this.entries,function(e,t){n.add(t)})};r.prototype.createEntry=function(t,r){var i=e.extend({id:r+1},t);t.date&&e.extend(i,{date:n(t.date),pubdate:function(){return dateFormat(n(t.date),"yyyy-mm-dd")},displaydate:function(){return dateFormat(n(t.date),"mmm dd, yyyy")}});return i};r.prototype.bindKeypress=function(){var n=this;this.$elem.bind("keyup",t(function(){n.search(e(this).val())}))};r.prototype.search=function(t){var n=this.entries;if(t.length<=2){this.$results.hide();this.$entries.empty()}else{var r=e.map(this.index.search(t),function(t){return e.grep(n,function(e){return e.id===parseInt(t.ref,10)})[0]});this.displayResults(r)}};r.prototype.displayResults=function(e){var t=this.$entries,n=this.$results;t.empty();e.length===0?t.append("<p>Nothing found.</p>"):t.append(this.template({entries:e}));n.show()};r.prototype.populateSearchFromQuery=function(){var e=new URI(window.location.search.toString()),t=e.search(!0);if(t.hasOwnProperty("q")){this.$elem.val(t.q);this.search(t.q.toString())}};return r}();e.fn.lunrSearch=function(t){t=e.extend({},e.fn.lunrSearch.defaults,t);new r(this,t);return this};e.fn.lunrSearch.defaults={indexUrl:"/search.json",results:"#search-results",entries:".entries",template:"#search-results-template"}})(jQuery);var dateFormat=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,r=function(e,t){e=String(e);t=t||2;while(e.length<t)e="0"+e;return e};return function(i,s,o){var u=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(i)=="[object String]"&&!/\d/.test(i)){s=i;i=undefined}i=i?new Date(i):new Date;if(isNaN(i))throw SyntaxError("invalid date");s=String(u.masks[s]||s||u.masks["default"]);if(s.slice(0,4)=="UTC:"){s=s.slice(4);o=!0}var a=o?"getUTC":"get",f=i[a+"Date"](),l=i[a+"Day"](),c=i[a+"Month"](),h=i[a+"FullYear"](),p=i[a+"Hours"](),d=i[a+"Minutes"](),v=i[a+"Seconds"](),m=i[a+"Milliseconds"](),g=o?0:i.getTimezoneOffset(),y={d:f,dd:r(f),ddd:u.i18n.dayNames[l],dddd:u.i18n.dayNames[l+7],m:c+1,mm:r(c+1),mmm:u.i18n.monthNames[c],mmmm:u.i18n.monthNames[c+12],yy:String(h).slice(2),yyyy:h,h:p%12||12,hh:r(p%12||12),H:p,HH:r(p),M:d,MM:r(d),s:v,ss:r(v),l:r(m,3),L:r(m>99?Math.round(m/10):m),t:p<12?"a":"p",tt:p<12?"am":"pm",T:p<12?"A":"P",TT:p<12?"AM":"PM",Z:o?"UTC":(String(i).match(t)||[""]).pop().replace(n,""),o:(g>0?"-":"+")+r(Math.floor(Math.abs(g)/60)*100+Math.abs(g)%60,4),S:["th","st","nd","rd"][f%10>3?0:(f%100-f%10!=10)*f%10]};return s.replace(e,function(e){return e in y?y[e]:e.slice(1,e.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(e,t){return dateFormat(this,e,t)};